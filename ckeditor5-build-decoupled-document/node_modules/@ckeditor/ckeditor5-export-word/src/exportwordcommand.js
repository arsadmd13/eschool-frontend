/*
 *             Copyright (c) 2016 - 2020, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import _0x29b2b8 from'@ckeditor/ckeditor5-core/src/command';import{getStyles as _0x3cbd4b,getConverterOptions as _0x11a9b3}from'./utils';export default class c extends _0x29b2b8{constructor(_0x545c15){super(_0x545c15),this['set']('isBusy',!0x1);}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x58af62={}){const _0x4e7acc=this['editor'],t=_0x4e7acc['t'],_0x3c4e9b=_0x58af62['converterUrl']||'https://docx-converter.cke-cs.com/v1/convert';return this['isBusy']=!0x0,this['refresh'](),_0x3cbd4b(_0x58af62['stylesheets']||['EDITOR_STYLES'])['then'](_0x556b1a=>{const _0x542723={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x4e7acc['locale']['contentLanguageDirection']+'\x22>'+_0x4e7acc['getData']()+'</div>','css':_0x556b1a,'options':{..._0x58af62['converterOptions'],..._0x11a9b3(_0x4e7acc)}},_0x4baab1={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0x58af62['token']&&{'Authorization':_0x58af62['token']['value']}},'body':JSON['stringify'](_0x542723)};return window['fetch'](_0x3c4e9b,_0x4baab1)['then'](_0x505bf5=>{if(0xc8!==_0x505bf5['status'])throw _0x505bf5;return _0x505bf5['blob']();})['then'](_0x381044=>{this['o'](_0x381044,_0x58af62['fileName']||'document.docx');});})['catch'](_0x2e32e7=>{throw _0x4e7acc['plugins']['get']('Notification')['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0x2e32e7;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['o'](_0x2d54cd,_0x179619){const _0x41bfd9=document['createElement']('a');_0x41bfd9['href']=window['URL']['createObjectURL'](_0x2d54cd),_0x41bfd9['download']=_0x179619,_0x41bfd9['click'](),_0x41bfd9['remove']();}}