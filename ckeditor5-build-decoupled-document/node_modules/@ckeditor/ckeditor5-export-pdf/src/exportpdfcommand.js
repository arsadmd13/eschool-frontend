/*
 *             Copyright (c) 2016 - 2020, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import _0x3705c0 from'@ckeditor/ckeditor5-core/src/command';import{getStyles as _0x5516e2}from'./utils';export default class c extends _0x3705c0{constructor(_0x350c04){super(_0x350c04),this['set']('isBusy',!0x1);}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x221155={}){const _0xc32b87=this['editor'],t=_0xc32b87['t'],_0x1b1480=_0x221155['converterUrl']||'https://pdf-converter.cke-cs.com/v1/convert/',_0xd24457=_0x221155['dataCallback']||(_0x4f67da=>_0x4f67da['getData']());return this['isBusy']=!0x0,this['refresh'](),_0x5516e2(_0x221155['stylesheets']||['EDITOR_STYLES'])['then'](_0x53397b=>{const _0x48a8ef={'html':'<html>\x0a\x09\x09\x09\x09\x09\x09<head>\x0a\x09\x09\x09\x09\x09\x09\x09<meta\x20charset=\x22utf-8\x22>\x0a\x09\x09\x09\x09\x09\x09</head>\x0a\x09\x09\x09\x09\x09\x09<body>\x0a\x09\x09\x09\x09\x09\x09\x09<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0xc32b87['locale']['contentLanguageDirection']+'\x22>\x0a\x09\x09\x09\x09\x09\x09\x09\x09'+_0xd24457(_0xc32b87)+'\x0a\x09\x09\x09\x09\x09\x09\x09</div>\x0a\x09\x09\x09\x09\x09\x09<body>\x0a\x09\x09\x09\x09\x09</html>','css':_0x53397b,'options':_0x221155['converterOptions']},_0x327bf0={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/pdf',..._0x221155['token']&&{'Authorization':_0x221155['token']['value']},'x-cs-app-id':_0x221155['appID']||'cke5'},'body':JSON['stringify'](_0x48a8ef)};return window['fetch'](_0x1b1480,_0x327bf0)['then'](_0x441bac=>{if(0xc8!==_0x441bac['status'])throw _0x441bac;return _0x441bac['blob']();})['then'](_0x19a3fe=>{this['o'](_0x19a3fe,_0x221155['fileName']||'document.pdf');});})['catch'](_0x791ac9=>{throw _0xc32b87['plugins']['get']('Notification')['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.')),_0x791ac9;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['o'](_0x2e54e2,_0x1d3fe3){const _0x1a2d1a=document['createElement']('a');_0x1a2d1a['href']=window['URL']['createObjectURL'](_0x2e54e2),_0x1a2d1a['download']=_0x1d3fe3,_0x1a2d1a['click'](),_0x1a2d1a['remove']();}}